<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‰∫∫Ê©ü‰∏äÁè≠Â∞àÁî®‰ªªÂãôËøΩËπ§ - Ultra Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        .glass-card {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }
        body {
            background: radial-gradient(circle at top right, #1e293b, #0f172a);
        }
        /* ÂÆ¢Ë£ΩÂåñÊó•ÊúüÈÅ∏ÊìáÂô®Ê®£Âºè */
        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }
    </style>
</head>
<body class="min-h-screen text-slate-100 antialiased font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const GRADIENTS = [
            "from-indigo-500/20 to-blue-500/20",
            "from-purple-500/20 to-pink-500/20",
            "from-emerald-500/20 to-cyan-500/20",
            "from-amber-500/20 to-orange-500/20"
        ];

        function App() {
            const [tasks, setTasks] = useState(() => {
                const saved = localStorage.getItem('man_machine_tracker');
                return saved ? JSON.parse(saved) : [
                    { 
                        id: 1, 
                        title: "üíª ÁØÑ‰æãÂ∞àÊ°àÔºö‰∫∫Ê©üÂçî‰Ωú", 
                        isExpanded: true, 
                        subtasks: [], 
                        notes: "ÈÄôË£°ÂèØ‰ª•ÂØ´Ë®ªËß£ÊèêÈÜíËá™Â∑±Ôºå‰æãÂ¶ÇÔºöË®òÂæóË∑ü‰∏ªÁÆ°Â∞çÈΩäÈúÄÊ±Ç„ÄÇ",
                        deadline: "2024-12-31",
                        gradientIndex: 0 
                    }
                ];
            });

            const [newProjTitle, setNewProjTitle] = useState("");
            const [activeBulkId, setActiveBulkId] = useState(null);
            const [bulkText, setBulkText] = useState("");

            useEffect(() => {
                localStorage.setItem('man_machine_tracker', JSON.stringify(tasks));
            }, [tasks]);

            const addProject = (e) => {
                e.preventDefault();
                if (!newProjTitle.trim()) return;
                const newProj = { 
                    id: Date.now(), 
                    title: newProjTitle, 
                    isExpanded: true, 
                    subtasks: [],
                    notes: "",
                    deadline: "",
                    gradientIndex: Math.floor(Math.random() * GRADIENTS.length)
                };
                setTasks([newProj, ...tasks]);
                setNewProjTitle("");
            };

            const updateTaskField = (id, field, value) => {
                setTasks(tasks.map(t => t.id === id ? { ...t, [field]: value } : t));
            };

            const handleBulkAdd = (projectId) => {
                const lines = bulkText.split('\n').filter(line => line.trim() !== "");
                if (lines.length === 0) { setActiveBulkId(null); return; }
                const newSub = lines.map((text, i) => ({ id: Date.now() + i, text: text.trim(), completed: false }));
                setTasks(tasks.map(t => t.id === projectId ? { ...t, subtasks: [...t.subtasks, ...newSub] } : t));
                setBulkText(""); setActiveBulkId(null);
            };

            const getStatus = (subtasks) => {
                if (subtasks.length === 0) return { l: "Ê∫ñÂÇô‰∏≠", c: "bg-white/10" };
                const done = subtasks.filter(s => s.completed).length;
                const p = Math.round((done / subtasks.length) * 100);
                if (done === subtasks.length) return { l: "Â∑≤ÂÆåÊàê", c: "bg-emerald-500/40 text-emerald-200", p };
                return { l: "ÈÄ≤Ë°å‰∏≠", c: "bg-sky-500/40 text-sky-100", p };
            };

            return (
                <div className="max-w-3xl mx-auto py-16 px-6">
                    <header className="mb-14 text-center">
                        <h1 className="text-4xl md:text-5xl font-black tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-white to-purple-400 mb-3 leading-tight">
                            ‰∫∫Ê©ü‰∏äÁè≠Â∞àÁî®‰ªªÂãôËøΩËπ§
                        </h1>
                        <p className="text-slate-400 font-medium tracking-[0.2em] text-[10px] uppercase">Human-AI Hybrid Workflow Tracker</p>
                    </header>

                    {/* Êñ∞Â¢ûÂ∞àÊ°à */}
                    <form onSubmit={addProject} className="mb-12 flex gap-3 p-2 rounded-[2rem] glass-card border-white/10 shadow-2xl">
                        <input 
                            className="flex-1 bg-transparent border-none text-white placeholder-slate-500 px-6 py-4 focus:ring-0 outline-none text-lg"
                            placeholder="Ëº∏ÂÖ•Êñ∞ÁöÑ‰ªªÂãôÂ∞àÊ°à..."
                            value={newProjTitle}
                            onChange={e => setNewProjTitle(e.target.value)}
                        />
                        <button className="bg-gradient-to-br from-blue-500 to-indigo-600 text-white px-8 py-4 rounded-3xl font-black hover:brightness-125 transition-all active:scale-95">
                            Êñ∞Â¢ûÂ∞àÊ°à
                        </button>
                    </form>

                    <div className="space-y-10">
                        {tasks.map((task) => {
                            const status = getStatus(task.subtasks);
                            const gradient = GRADIENTS[task.gradientIndex || 0];

                            return (
                                <div key={task.id} className={`glass-card rounded-[2.5rem] overflow-hidden transition-all duration-500 bg-gradient-to-br ${gradient}`}>
                                    {/* ÊØçÈ†ÖÁõÆÊ®ôÈ°åËàáÊó•Êúü */}
                                    <div className="p-7 flex flex-wrap items-center justify-between gap-4 group">
                                        <div className="flex items-center gap-4 flex-1 min-w-[300px]">
                                            <button 
                                                onClick={() => updateTaskField(task.id, 'isExpanded', !task.isExpanded)}
                                                className="w-12 h-12 flex items-center justify-center rounded-2xl bg-white/10 hover:bg-white/20 text-white"
                                            >
                                                {task.isExpanded ? "‚ñº" : "‚ñ∂"}
                                            </button>
                                            <div className="flex-1">
                                                <input 
                                                    className="text-xl font-bold text-white bg-transparent border-none focus:ring-0 w-full placeholder-white/20"
                                                    value={task.title}
                                                    onChange={e => updateTaskField(task.id, 'title', e.target.value)}
                                                />
                                            </div>
                                        </div>
                                        
                                        <div className="flex items-center gap-4">
                                            {/* Deadline Êó•Êúü */}
                                            <div className="flex items-center gap-2 bg-black/20 px-3 py-1.5 rounded-xl border border-white/5">
                                                <span className="text-[10px] text-slate-400 font-bold">üìÖ DEADLINE</span>
                                                <input 
                                                    type="date"
                                                    className="bg-transparent text-xs font-bold text-white outline-none cursor-pointer"
                                                    value={task.deadline}
                                                    onChange={e => updateTaskField(task.id, 'deadline', e.target.value)}
                                                />
                                            </div>
                                            <span className={`text-[10px] font-black px-3 py-2 rounded-xl uppercase tracking-wider shadow-sm ${status.c}`}>
                                                {status.l} {status.p ? `${status.p}%` : ""}
                                            </span>
                                            <button onClick={() => confirm('Âà™Èô§Â∞àÊ°àÔºü') && setTasks(tasks.filter(t => t.id !== task.id))} className="text-white/20 hover:text-red-400 px-2 transition-colors">‚úï</button>
                                        </div>
                                    </div>

                                    {/* ‰∏ãÊãâÂ±ïÈñãÂÖßÂÆπ */}
                                    {task.isExpanded && (
                                        <div className="px-10 pb-10 space-y-6 animate-in slide-in-from-top-4 duration-300">
                                            
                                            {/* Â∞àÊ°àË®ªËß£ÂçÄ */}
                                            <div className="bg-black/20 rounded-2xl p-4 border border-white/5">
                                                <div className="flex items-center gap-2 mb-2">
                                                    <span className="text-xs font-bold text-blue-300">üìù Â∞àÊ°àÂÇôË®ª / ÊèêÈÜí‰∫ãÈ†Ö</span>
                                                </div>
                                                <textarea 
                                                    className="w-full bg-transparent border-none text-sm text-slate-300 placeholder-white/10 focus:ring-0 resize-none h-16 leading-relaxed"
                                                    placeholder="Âú®ÈÄôË£°ÂØ´‰∏ãÈÄôÂÄãÂ∞àÊ°àÁöÑÊ≥®ÊÑè‰∫ãÈ†Ö..."
                                                    value={task.notes}
                                                    onChange={e => updateTaskField(task.id, 'notes', e.target.value)}
                                                />
                                            </div>

                                            {/* Â≠ê‰ªªÂãôÂàóË°® */}
                                            <div className="space-y-4">
                                                {task.subtasks.map(sub => (
                                                    <div key={sub.id} className="flex items-center gap-4 group/item">
                                                        <div 
                                                            onClick={() => {
                                                                const newSub = task.subtasks.map(s => s.id === sub.id ? {...s, completed: !s.completed} : s);
                                                                updateTaskField(task.id, 'subtasks', newSub);
                                                            }}
                                                            className={`w-6 h-6 rounded-lg border-2 flex items-center justify-center cursor-pointer transition-all ${sub.completed ? 'bg-white border-white' : 'bg-transparent border-white/30 hover:border-white'}`}
                                                        >
                                                            {sub.completed && <span className="text-slate-900 text-[10px] font-black">‚úì</span>}
                                                        </div>
                                                        <input 
                                                            className={`text-base bg-transparent border-none focus:ring-0 w-full transition-all ${sub.completed ? 'line-through text-white/30' : 'text-white/80'}`}
                                                            value={sub.text}
                                                            onChange={e => {
                                                                const newSub = task.subtasks.map(s => s.id === sub.id ? {...s, text: e.target.value} : s);
                                                                updateTaskField(task.id, 'subtasks', newSub);
                                                            }}
                                                        />
                                                        <button onClick={() => {
                                                            const newSub = task.subtasks.filter(s => s.id !== sub.id);
                                                            updateTaskField(task.id, 'subtasks', newSub);
                                                        }} className="text-white/10 hover:text-white/60 opacity-0 group-hover/item:opacity-100 transition-opacity">‚úï</button>
                                                    </div>
                                                ))}
                                            </div>

                                            {/* Êñ∞Â¢ûÂ∑•ÂÖ∑ÂçÄ */}
                                            <div className="pt-6 border-t border-white/10 flex justify-between items-center">
                                                {activeBulkId === task.id ? (
                                                    <div className="w-full space-y-4">
                                                        <textarea 
                                                            className="w-full h-32 p-4 bg-black/30 border border-white/10 rounded-2xl text-white text-sm outline-none focus:border-white/30"
                                                            placeholder="Ë≤º‰∏ä‰∏ÄË°å‰∏ÄÂÄã‰ªªÂãô..."
                                                            value={bulkText}
                                                            onChange={e => setBulkText(e.target.value)}
                                                            autoFocus
                                                        />
                                                        <div className="flex gap-2">
                                                            <button onClick={() => handleBulkAdd(task.id)} className="bg-white text-slate-900 px-4 py-2 rounded-xl text-xs font-black uppercase">ÂÆåÊàêË≤º‰∏ä</button>
                                                            <button onClick={() => setActiveBulkId(null)} className="text-white/50 px-4 py-2 text-xs hover:text-white">ÂèñÊ∂à</button>
                                                        </div>
                                                    </div>
                                                ) : (
                                                    <>
                                                        <input 
                                                            className="bg-transparent border-none text-sm placeholder-white/20 focus:ring-0 w-2/3"
                                                            placeholder="Ôºã Ëº∏ÂÖ•‰ªªÂãôÂæåÊåâ Enter"
                                                            onKeyDown={e => {
                                                                if (e.key === 'Enter') {
                                                                    setBulkText(e.target.value);
                                                                    handleBulkAdd(task.id);
                                                                    e.target.value = "";
                                                                }
                                                            }}
                                                        />
                                                        <button 
                                                            onClick={() => setActiveBulkId(task.id)}
                                                            className="text-[10px] font-bold uppercase tracking-tighter bg-white/10 px-3 py-1 rounded-lg hover:bg-white/20 transition-all"
                                                        >
                                                            ‚ö° ÊâπÈáèÊ®°Âºè
                                                        </button>
                                                    </>
                                                )}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            );
                        })}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
